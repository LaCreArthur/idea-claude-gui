<idea-plugin>
    <id>com.lacrearthur.idea-claude-gui</id>
    <name>IDEA Claude Code GUI</name>
    <vendor>LaCreArthur</vendor>

    <!-- Resource bundle for i18n -->
    <resource-bundle>messages.ClaudeCodeGuiBundle</resource-bundle>

    <description><![CDATA[
        <p><strong>IDEA Claude Code GUI</strong> - A powerful visual interface plugin that brings <strong>Claude Code</strong> and <strong>OpenAI Codex</strong> dual AI tools directly into IntelliJ IDEA, making AI-assisted programming more efficient and intuitive.</p>

        <h2>Dual AI Engine Support</h2>
        <ul>
            <li><strong>Claude Code</strong> - Anthropic's official AI programming assistant (Opus 4.5 and more)</li>
            <li><strong>OpenAI Codex</strong> - OpenAI's powerful code generation engine</li>
        </ul>

        <h2>Key Features</h2>
        <ul>
            <li><strong>Context-aware AI Assistant</strong>: Intelligent coding assistant with @file reference support</li>
            <li><strong>Image Support</strong>: Send images for visual requirement description</li>
            <li><strong>Agent System</strong>: Built-in agents for automated complex tasks</li>
            <li><strong>Skills Commands</strong>: Slash command system (/init, /review, etc.)</li>
            <li><strong>MCP Server</strong>: Extend AI capabilities with MCP protocol</li>
            <li><strong>Code DIFF</strong>: Visual code comparison and file navigation</li>
            <li><strong>Conversation Rewind</strong>: Flexible history adjustment</li>
            <li><strong>Session Management</strong>: History, favorites, search, and export</li>
            <li><strong>Theme Support</strong>: Dark/Light themes with IDE font sync</li>
            <li><strong>Permission Control</strong>: Comprehensive security management</li>
            <li><strong>Provider Management</strong>: cc-switch compatible</li>
        </ul>

        <h2>How to Use</h2>
        <ul>
            <li>Open the Claude Code GUI tool window from the right sidebar</li>
            <li>Select code and use <kbd>Ctrl+Alt+K</kbd> (Win/Linux) or <kbd>Cmd+Alt+K</kbd> (Mac) to send to AI</li>
            <li>Get instant AI-powered code assistance and intelligent suggestions</li>
        </ul>

        <p><em>Keywords: Claude, Claude Code, Codex, OpenCode, Gemini, AI Assistant, Code Generation, AI Coding, Productivity, Intelligent Code Assistant</em></p>
    ]]></description>

    <depends>com.intellij.modules.platform</depends>
    <!-- Optional: Java support for enhanced context collection in Java/Kotlin IDEs -->
    <depends optional="true" config-file="java-features.xml">com.intellij.java</depends>

    <extensions defaultExtensionNs="com.intellij">
        <!-- Claude Code GUI Tool Window (includes history) -->
        <toolWindow id="CCG"
                    anchor="right"
                    factoryClass="com.github.claudecodegui.ClaudeSDKToolWindow"
                    icon="/icons/cc-gui-icon.svg"
                    canCloseContents="true"/>

        <!-- Pre-extract AI Bridge on project open to avoid EDT freeze -->
        <postStartupActivity implementation="com.github.claudecodegui.startup.BridgePreloader"/>

        <!-- Cleanup old ai-bridge cache when plugin version changes -->
        <postStartupActivity implementation="com.github.claudecodegui.startup.PluginUpdateListener"/>

        <!-- StatusBar widget for task notification -->
        <statusBarWidgetFactory id="ClaudeStatusBarWidget"
                                implementation="com.github.claudecodegui.notifications.ClaudeStatusBarWidget$Factory"/>
    </extensions>

    <actions>
        <!-- Send selected code to AI action -->
        <action id="ClaudeCodeGUI.SendSelectionToTerminalAction"
                class="com.github.claudecodegui.SendSelectionToTerminalAction"
                icon="/icons/send-to-terminal.svg">
            <!-- Add to editor context menu (show at top) -->
            <add-to-group group-id="EditorPopupMenu" anchor="first"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl alt K"/>
            <keyboard-shortcut keymap="Mac OS X" first-keystroke="meta alt K"/>
            <keyboard-shortcut keymap="macOS" first-keystroke="meta alt K"/>
        </action>

        <!-- Quick Fix with Claude Action -->
        <action id="ClaudeCodeGUI.QuickFixWithClaudeAction"
                class="com.github.claudecodegui.QuickFixWithClaudeAction"
                icon="/icons/quick-fix.svg">
            <add-to-group group-id="EditorPopupMenu"
                           anchor="after"
                           relative-to-action="ClaudeCodeGUI.SendSelectionToTerminalAction"/>
        </action>

        <!-- Create New Tab Action (can be invoked via Find Action or programmatically) -->
        <action id="ClaudeCodeGUI.CreateNewTabAction"
                class="com.github.claudecodegui.CreateNewTabAction"
                icon="AllIcons.General.Add"
                text="New Chat Tab"
                description="Create a new chat tab in Claude Code GUI tool window"/>
    </actions>
</idea-plugin>
